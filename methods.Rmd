---
title: "covid-19"
author: "dsrittman"
date: "4/22/2020"
output: html_document
---

## Methods for Developing COVID Models


**Background**    

The initial phase of the COVID-19 epidemic indicated exponential growth potential both worldwide and locally. This suggests that without intervention, the infections would grow and then decay exponentially. This has sparked the motivation for instituting efforts to “flatten the curve”. While multiple efforts have been made to predict the long-term trajectory of COVID-19, using deterministic and stochastic based methods, they all require heavy assumptions with unknown accuracy. As we learn more about the etiology of the disease and its transmissibility, these long-term models will be refined.
Although long-term forecasting is evolving, short-term forecasting built upon simple models using basic assumptions are critical for documenting and identifying changes in our trajectory.[[1]](#references) These short-term models can assist us with monitoring the impact of implementing and relaxing health mandates to inform our public health efforts; simply put, we can monitor how things are progressing.


**Methods**   

We used the incidence[[1]](#references) package in R[[2]](#references) to model the short term epidemic trajectory using a log-linear model under the form:

log(y) = r*t+b

Where, ‘y’ is the daily incidence, ‘t’ is the time in days from the start of the outbreak, ‘r’ is the growth rate, and ‘b’ is the origin or intercept. 

Update: We expanded the window from 14 - 21 days to inform the model. This was expanded to reduce the influence of a single data point on the overall model and smooth out projections. Due to the rise in cases, and delay in reporting and identifying/collecting the onset date, we based the model on our imputed estimate of the onset date when unknown. These methods are described below.  

Assuming that without mitigation efforts the disease will spread at an exponential rate, we modeled the observed daily case counts over a 21-day period based on date of onset, and projected out 17 days. Due to the delay between an individual recognizing symptoms, being tested, and those results being reported to the State, when an onset date is not yet known, the current practice is to substitute the reported date. To account for the fact that most of these substitution dates occur during the most recent week, a simple imputation method was developed to assign a temporary onset date by sampling from a truncated gamma distribution with a median of 6 days. This imputation helps guard against making estimations that are attenuated due to limitations in data collection opposed to impacts related to the disease transmission. Additionally, due to future cases that are yet to be reported likely having onset dates during the most recent week of collection, correction methods or truncation of 7 days is also required. These methods guard against creating models that produce biased trajectories.

We truncated by seven days, due to the median duration from onset date to report date being approximately 6 days and attenuating in recent weeks. However, even with truncation and our imputation method, the results could be biased in the slope of the trajectory if the number of cases not yet reported substantially lags behind our estimation window. 

We used the most recent 21-day period minus the 7-day truncation period to project out 17 days (14 day’s beyond the last report date). The use of this 21 day window for the statewide estimate was chosen by convention with short-term projections, where the assumption is that more recent trends likely better approximate the current trajectory.   

The code for imputing an onset date when unknown:  
```{r eval = FALSE}
  dat1$ReportDate <- as.Date(with(dat1, ifelse(OnsetDateReplaced == 2, dat1$OnsetDate,
                                               NA)), origin = "1970-01-01")
  
  dat1$duration <- dat1$ReportDate - dat1$OnsetDate
  
  ## set distribution for median
  set.seed(2020)
  library(heavy)
  dist <- round(rtgamma(50000, shape =  6, truncation = 14)) 
  zro <- table(dat1$duration)
  
  set.seed(19) 
  smp1 <- sample(dist, zro)
  
  dat1$duration_imp <- ifelse(dat1$duration == 0, smp1, dat1$duration)

  dat1$OnsetDate1 <- as.Date(ifelse(is.na(dat1$duration), dat1$OnsetDate,
                                    dat1$OnsetDate - dat1$duration_imp),
                             origin = "1970-01-01")
```


**Interpretation**    

The first plot is based on daily incremental incidence counts often called the epidemic curve. The second plot is the daily additive counts of new cases, or cumulative incidence. Both plots use the date of onset. Currently however, only the daily incidence plot uses the imputed onset date if unknown and 21 day window. We’ve used gray bars (epidemic curve plot) and gray dots (cumulative incidence plot) to denote the truncated date from the model fit.

Generally, when the daily epidemic curve plot trajectory is decreasing, this means the number of new daily onset cases is getting smaller, suggesting the mitigation strategies are having an impact or the disease is dying out. Likewise, when the cumulative incidence trajectory flattens and appears more linear, this indicates a reduction in the number of new cases added to the total each day. 

The difference in confidence bands (indicated by the gray band) are related to the amount of variability between the numbers. With cumulative case counts much less variability is observed compared to daily case counts, resulting in less residual error between observations and smaller bands.  

These short term forecasts will update daily and project an estimated exponential trajectory. Watching how daily observations compare to these trajectories can provide information about whether the course of the epidemic in Alaska remains on the same track or whether it is growing or declining more quickly or more slowly than previously observed.


**References**  

[[1]](https://doi.org/10.1016/j.epidem.2017.02.012) Nouvellet, P., Cori, A., Garske, T., Blake, I.M., Dorigatti, I., Hinsley, W., Jombart, T., Mills, H.L., Nedjati-Gilani, G., Kerkhove, M.D.V., Fraser, C., Donnelly, C.A., Ferguson, N.M. and Riley, S., A simple approach to measure transmissibility and forecast incidence, 2018. Epidemics, Vol 22, pp. 29 - 35.)

[[2]](https://doi.org/10.5281/zenodo.2584018) Thibaut Jombart, Zhian N. Kamvar, Rich FitzJohn, Jun Cai, Sangeeta Bhatia, Jakob
Schumacher and Juliet R.C. Pulliam (2020). incidence: Compute, Handle, Plot and Model
Incidence of Dated Events. R package version 1.7.1.

[[3]](https://www.r-project.org/) R: A Language and Environment for Statistical Computing, R Core Team, 2019.    



**Note:**  
The code that created this application is available at:   
<https://github.com/AK-MCH-EPI/AK_COVID>  
last updated: 2020-08-07 
